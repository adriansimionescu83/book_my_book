<%= form_with(model: @book, local: true, class: "max-w-[900px] mx-auto p-6 bg-blue-50 border flex flex-col rounded shadow-md m-5", data: {"controller": "image-preview"}) do |form| %>

  <div class="flex w-full gap-2">

    <div class="w-full">
      <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">
          Title <span class="text-red-500">*</span>
        </label>
        <%= form.text_field :title, required: true, class: "mt-1 block w-full min-w-[18rem] border border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50" %>
      </div>
      
      <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">
          Author <span class="text-red-500">*</span>
        </label>
        <%= form.text_field :author, required: true, class: "mt-1 block w-full min-w-[18rem] border border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50" %>
      </div>
      
      <div class="mb-4">
        <%= form.label :description, class: "block text-sm font-medium text-gray-700" %>
        <%= form.text_area :description, maxlength: 250, class: "mt-1 block w-full min-w-[18rem] border border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50" %>
      </div>

      <div class="mb-4">
        <%= form.label :category_id, class: "block text-sm font-medium text-gray-700" %>
        <%= form.collection_select :category_id, Category.all, :id, :name, { prompt: 'Select a category' }, { class: "mt-1 block w-full min-w-[18rem] border border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50" } %>
      </div>
      
      <div class="mb-4">
        <%= form.label :language_id, class: "block text-sm font-medium text-gray-700" %>
        <%= form.collection_select :language_id, Language.all, :id, :name, { prompt: 'Select a language', selected: Language.find_by(name: 'English').id }, { class: "mt-1 block w-full min-w-[18rem] border border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50" } %>
      </div>

      <div class="mb-4">
        <%= form.label :age_group_id, class: "block text-sm font-medium text-gray-700" %>
        <%= form.collection_select :age_group_id, AgeGroup.all, :id, :name, { prompt: 'Select an age group' }, { class: "mt-1 block w-full min-w-[18rem] border border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50" } %>
      </div>

      <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">
          Price <span class="text-red-500">*</span> <span class="text-gray-500">(AED)</span>
        </label>
        <%= form.number_field :price, required: true, class: "mt-1 block w-full min-w-[18rem] border border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50" %>
      </div>
      
      <div class="mb-4">
        <%= form.label :status, class: "block text-sm font-medium text-gray-700" %>
        <%= form.select :status, [['Available', 'available'], ['Sold', 'sold'], ['Reserved', 'reserved']], { selected: 'available' }, { class: "mt-1 block w-full min-w-[18rem] border border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50" } %>
      </div>

      <div class="mb-4">
        <%= form.label :photo, "Upload Photo", class: "block text-sm font-medium text-gray-700" %>
        <%= form.file_field :photo, class: "mt-1 block w-full min-w-[18rem] border border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50",
          direct_upload: true,
          data: { image_preview_target: 'input', action: "change->image-preview#preview"} %>
      </div>
    </div>

    <div class="w-full bg-gray-200 p-2 flex justify-center items-center">

      <% if @book.photo.attached? %>
        <%= image_tag @book.photo, height: 500, width: 300, data: {image_preview_target: "preview"}, class: "w-full h-full object-contain" %>
      <% else %>
        <%= image_tag 'bookwheel_logo.png', data: {image_preview_target: "preview"}, class: "w-full h-full object-contain" %>
      <% end %>    

    </div>
  </div>


  <div class="flex justify-center">
    <%= form.submit 'Add Book', class: "mt-4 bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded w-1/3" %>
  </div>
<% end %>